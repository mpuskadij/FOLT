<ui:composition template="/predlozak.xhtml"
	xmlns:ui="jakarta.faces.facelets" xmlns:h="jakarta.faces.html"
	xmlns:f="jakarta.faces.core">

	<ui:define name="title">Nova narudžba</ui:define>
	<ui:define name="content">
	<h2>Nova narudžba</h2>
		<br />		
	<h:form id="formaDopune">
		
		<h:panelGroup rendered= "#{novaNarudzba.poruka.isBlank()}" layout="block" style="margin-bottom:30px; border:1px solid #ccc; padding:10px;">

            <h:commandButton value="Stvori račun" action="#{novaNarudzba.platiRacun}">
            	<f:ajax execute="@form" render="@form" />
            </h:commandButton>
            <h:panelGrid columns="2" cellpadding="5">
                <h:outputLabel for="jeloSelect" value="Odaberi jelo:" />
                <h:selectOneMenu id="jeloSelect" value="#{novaNarudzba.odabranoJelo}">
                    <f:selectItems value="#{pregledJelovnikaPartnera.jelovnici}" var="j"
                                   itemValue="#{j.id()}" itemLabel="#{j.naziv()}" />
                </h:selectOneMenu>

                <h:outputLabel for="kolicinaJelo" value="Količina (1-100):" />
                <h:inputText id="kolicinaJelo" value="#{novaNarudzba.kolicinaJela}" required="true">
                    <f:validateLongRange minimum="1" maximum="100" />
                </h:inputText>

                <h:outputText value="" />
                <h:commandButton value="Naruči jelo" action="#{novaNarudzba.naruciJelo}">
                	            <f:ajax execute="@form" render="@form" />
               	</h:commandButton>
            </h:panelGrid>
            <h:panelGrid columns="2" cellpadding="5">
                <h:outputLabel for="piceSelect" value="Odaberi piće:" />
                <h:selectOneMenu id="piceSelect" value="#{novaNarudzba.odabranoPice}">
                    <f:selectItems value="#{pregledKartePicaPartnera.kartePica}" var="p"
                                   itemValue="#{p.id()}" itemLabel="#{p.naziv()}" />
                </h:selectOneMenu>

                <h:outputLabel for="kolicinaPice" value="Količina (1-100):" />
                <h:inputText id="kolicinaPice" value="#{novaNarudzba.kolicinaPica}" required="true">
                    <f:validateLongRange minimum="1" maximum="100" />
                </h:inputText>

                <h:outputText value="" />
                <h:commandButton value="Naruči piće" action="#{novaNarudzba.naruciPice}">
                			<f:ajax execute="@form" render="@form" />
                </h:commandButton>
            </h:panelGrid>

    </h:panelGroup>

    <h:panelGrid id="naruceneStavke" columns="2" columnClasses="left,right" cellpadding="10" rendered= "#{novaNarudzba.poruka.isBlank()}">

        <h:panelGroup layout="block">
            <h3>Naručena jela</h3>
            <h:dataTable value="#{novaNarudzba.narucenaJela}" var="j" border="1">
                <h:column>
                    <f:facet name="header">Naziv</f:facet>
                    #{j.id()}
                </h:column>
                <h:column>
                    <f:facet name="header">Količina</f:facet>
                    #{j.kolicina()}
                </h:column>
                <h:column>
                    <f:facet name="header">Cijena</f:facet>
                    #{j.cijena()}
                </h:column>
                <h:column>
                    <f:facet name="header">Iznos</f:facet>
                    #{j.kolicina() * j.cijena()}
                </h:column>
            </h:dataTable>
        </h:panelGroup>

        <h:panelGroup layout="block">
            <h3>Naručena pića</h3>
            <h:dataTable value="#{novaNarudzba.narucenaPica}" var="p" border="1">
                <h:column>
                    <f:facet name="header">Naziv</f:facet>
                    #{p.id()}
                </h:column>
                <h:column>
                    <f:facet name="header">Količina</f:facet>
                    #{p.kolicina()}
                </h:column>
                <h:column>
                    <f:facet name="header">Cijena</f:facet>
                    #{p.cijena()}
                </h:column>
                <h:column>
                    <f:facet name="header">Iznos</f:facet>
                    #{p.kolicina() * p.cijena()}
                </h:column>
            </h:dataTable>
        </h:panelGroup>

    </h:panelGrid>
    <h:outputText id="poruka" value="#{novaNarudzba.poruka}" /> 
	</h:form>
	
    
    
    
	</ui:define>
	<ui:define name="nav">
	</ui:define>	
</ui:composition>